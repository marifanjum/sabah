<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Social Card Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-100 p-6">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useRef } = React;

      function App() {
        const [width, setWidth] = useState(1080);
        const [height, setHeight] = useState(1080);
        const [headlines, setHeadlines] = useState([]);
        const [images, setImages] = useState([]);
        const [logo, setLogo] = useState(null);
        const [fileName, setFileName] = useState("instagram_post.png");
        const [fitMode, setFitMode] = useState("cover");
        const [vignette, setVignette] = useState(true);
        const [globalBorderColor, setGlobalBorderColor] = useState("#000000");
        const [globalBorderSize, setGlobalBorderSize] = useState(5);

        // new background state
        const [backgroundImage, setBackgroundImage] = useState({ show: false, src: "bg.png" });
        const [gradient, setGradient] = useState({
          show: false,
          color1: "#000000",
          color2: "#ffffff",
          direction: "to bottom"
        });

        const containerRef = useRef(null);

        // Presets storage
        const [presets, setPresets] = useState({});

        const savePreset = (name) => {
          const newPreset = {
            headlines,
            images,
            width,
            height,
            logo,
            fileName,
            fitMode,
            vignette,
            globalBorderColor,
            globalBorderSize,
            backgroundImage,
            gradient
          };
          setPresets({ ...presets, [name]: newPreset });
        };

        const loadPreset = (name) => {
          const preset = presets[name];
          if (!preset) return;
          setHeadlines(preset.headlines || []);
          setImages(preset.images || []);
          setWidth(preset.width || 1080);
          setHeight(preset.height || 1080);
          setLogo(preset.logo || null);
          setFileName(preset.fileName || "instagram_post.png");
          setFitMode(preset.fitMode || "cover");
          setVignette(preset.vignette || true);
          setGlobalBorderColor(preset.globalBorderColor || "#000000");
          setGlobalBorderSize(preset.globalBorderSize || 5);
          setBackgroundImage(preset.backgroundImage || { show: false, src: "bg.png" });
          setGradient(preset.gradient || {
            show: false,
            color1: "#000000",
            color2: "#ffffff",
            direction: "to bottom"
          });
        };

        return (
          <div className="flex space-x-6">
            {/* Controls */}
            <div className="w-80 space-y-4">
              <div className="bg-white p-3 rounded shadow">
                <h3 className="text-lg font-medium mb-2">Canvas settings</h3>
                <label className="block text-sm">Width</label>
                <input
                  type="number"
                  value={width}
                  onChange={(e) => setWidth(parseInt(e.target.value))}
                  className="w-full border p-1 rounded mb-2"
                />
                <label className="block text-sm">Height</label>
                <input
                  type="number"
                  value={height}
                  onChange={(e) => setHeight(parseInt(e.target.value))}
                  className="w-full border p-1 rounded mb-2"
                />
                <label className="block text-sm">Border color</label>
                <input
                  type="color"
                  value={globalBorderColor}
                  onChange={(e) => setGlobalBorderColor(e.target.value)}
                  className="w-full border p-1 rounded mb-2"
                />
                <label className="block text-sm">Border size</label>
                <input
                  type="number"
                  value={globalBorderSize}
                  onChange={(e) => setGlobalBorderSize(parseInt(e.target.value))}
                  className="w-full border p-1 rounded mb-2"
                />
              </div>

              {/* Background options */}
              <div className="bg-white p-3 rounded shadow mt-4">
                <h3 className="text-lg font-medium mb-2">Background</h3>

                <label className="flex items-center mb-2">
                  <input
                    type="checkbox"
                    checked={backgroundImage.show}
                    onChange={(e) =>
                      setBackgroundImage({ ...backgroundImage, show: e.target.checked })
                    }
                  />
                  <span className="ml-2">Use background image</span>
                </label>

                <label className="flex items-center mb-2">
                  <input
                    type="checkbox"
                    checked={gradient.show}
                    onChange={(e) =>
                      setGradient({ ...gradient, show: e.target.checked })
                    }
                  />
                  <span className="ml-2">Use gradient</span>
                </label>

                {gradient.show && (
                  <div className="space-y-2 mt-2">
                    <label className="block text-sm">Color 1</label>
                    <input
                      type="color"
                      value={gradient.color1}
                      onChange={(e) =>
                        setGradient({ ...gradient, color1: e.target.value })
                      }
                    />

                    <label className="block text-sm">Color 2</label>
                    <input
                      type="color"
                      value={gradient.color2}
                      onChange={(e) =>
                        setGradient({ ...gradient, color2: e.target.value })
                      }
                    />

                    <label className="block text-sm">Direction</label>
                    <select
                      value={gradient.direction}
                      onChange={(e) =>
                        setGradient({ ...gradient, direction: e.target.value })
                      }
                      className="w-full border p-1 rounded"
                    >
                      <option value="to bottom">Top → Bottom</option>
                      <option value="to top">Bottom → Top</option>
                      <option value="to right">Left → Right</option>
                      <option value="to left">Right → Left</option>
                      <option value="to bottom right">Diagonal ↘</option>
                      <option value="to bottom left">Diagonal ↙</option>
                    </select>
                  </div>
                )}
              </div>

              {/* Preset controls */}
              <div className="bg-white p-3 rounded shadow mt-4">
                <h3 className="text-lg font-medium mb-2">Presets</h3>
                <input
                  type="text"
                  id="presetName"
                  placeholder="Preset name"
                  className="w-full border p-1 rounded mb-2"
                />
                <button
                  className="bg-blue-500 text-white px-3 py-1 rounded mr-2"
                  onClick={() =>
                    savePreset(document.getElementById("presetName").value)
                  }
                >
                  Save
                </button>
                <select
                  onChange={(e) => loadPreset(e.target.value)}
                  className="w-full border p-1 rounded mt-2"
                >
                  <option value="">Load preset</option>
                  {Object.keys(presets).map((key) => (
                    <option key={key} value={key}>
                      {key}
                    </option>
                  ))}
                </select>
              </div>
            </div>

            {/* Canvas */}
            <div
              ref={containerRef}
              className="relative mx-auto border"
              style={{
                width: `${width}px`,
                height: `${height}px`,
                border: `${globalBorderSize}px solid ${globalBorderColor}`,
                background: backgroundImage.show
                  ? `url(${backgroundImage.src}) center/cover no-repeat`
                  : gradient.show
                  ? `linear-gradient(${gradient.direction}, ${gradient.color1}, ${gradient.color2})`
                  : "#000"
              }}
            >
              <div className="absolute inset-0 flex items-center justify-center text-white font-bold">
                Preview Area
              </div>
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
