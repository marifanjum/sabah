<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Social Card Generator</title>
	  <link href="
https://cdn.jsdelivr.net/npm/jameel-noori@1.1.2/jameel-noori.min.css
" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
	  
    <style>
      @font-face {
        font-family: "Pangea Afrikan Trial";
        src: url("https://db.onlinewebfonts.com/t/11650c78ba93a8c78b44eff5c3628f9e.eot");
        src: url("https://db.onlinewebfonts.com/t/11650c78ba93a8c78b44eff5c3628f9e.eot?#iefix") format("embedded-opentype"),
          url("https://db.onlinewebfonts.com/t/11650c78ba93a8c78b44eff5c3628f9e.woff2") format("woff2"),
          url("https://db.onlinewebfonts.com/t/11650c78ba93a8c78b44eff5c3628f9e.woff") format("woff"),
          url("https://db.onlinewebfonts.com/t/11650c78ba93a8c78b44eff5c3628f9e.ttf") format("truetype"),
          url("https://db.onlinewebfonts.com/t/11650c78ba93a8c78b44eff5c3628f9e.svg#Pangea Afrikan Trial") format("svg");
      }

      @keyframes slide-in {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }
      .drawer-open {
        animation: slide-in 0.3s ease-out forwards;
      }

      .drawer-overlay {
        backdrop-filter: blur(2px);
        background-color: rgba(0, 0, 0, 0.4);
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
      function SocialCardGenerator() {
        const { useState, useRef, useEffect } = React;
        const containerRef = useRef(null);
        const textRef = useRef(null);

        const [images, setImages] = useState([]);
        const [activeImageId, setActiveImageId] = useState(null);
        const [width, setWidth] = useState(1080);
        const [height, setHeight] = useState(1080);
        const [headline, setHeadline] = useState("Headline here");
        const [fontSize, setFontSize] = useState(72);
        const [lineHeight, setLineHeight] = useState(1.2);
        const [fontFamily, setFontFamily] = useState("Jameel Noori Nastaleeq");
        const [textColor, setTextColor] = useState("#ffffff");
        const [textPos, setTextPos] = useState({ x: 100, y: 200 });
        const [direction, setDirection] = useState("rtl");
        const [logo, setLogo] = useState({ show: true, position: "top-right" });
        const [fileName, setFileName] = useState("social-card");
        const [sidelineOffset, setSidelineOffset] = useState(0);
        const [shadow, setShadow] = useState({ enabled: true, offsetX: 2, offsetY: 2, blur: 6, color: "rgba(0,0,0,0.6)" });
        const [stroke, setStroke] = useState({ enabled: false, width: 1, color: "#000000" });
        const [sideline, setSideline] = useState({ show: true, width: 4, gap: 8, height: 0, color: "#ff0000", opacity: 1 });
        const [fitMode, setFitMode] = useState("cover");
        
        const [showControls, setShowControls] = useState(false);
        const [touchStartDist, setTouchStartDist] = useState(null);

        // Load data from local storage on initial render
        useEffect(() => {
          try {
            const savedData = localStorage.getItem('socialCardData');
            if (savedData) {
              const parsedData = JSON.parse(savedData);
              if (parsedData.headline) setHeadline(parsedData.headline);
              if (parsedData.images) setImages(parsedData.images);
              if (parsedData.width) setWidth(parsedData.width);
              if (parsedData.height) setHeight(parsedData.height);
              if (parsedData.fontSize) setFontSize(parsedData.fontSize);
              if (parsedData.lineHeight) setLineHeight(parsedData.lineHeight);
              if (parsedData.fontFamily) setFontFamily(parsedData.fontFamily);
              if (parsedData.textColor) setTextColor(parsedData.textColor);
              if (parsedData.textPos) setTextPos(parsedData.textPos);
              if (parsedData.direction) setDirection(parsedData.direction);
              if (parsedData.logo) setLogo(parsedData.logo);
              if (parsedData.fileName) setFileName(parsedData.fileName);
              if (parsedData.sidelineOffset) setSidelineOffset(parsedData.sidelineOffset);
              if (parsedData.shadow) setShadow(parsedData.shadow);
              if (parsedData.stroke) setStroke(parsedData.stroke);
              if (parsedData.sideline) setSideline(parsedData.sideline);
              if (parsedData.fitMode) setFitMode(parsedData.fitMode);
            }
          } catch (e) {
            console.error("Failed to load data from localStorage", e);
          }
        }, []);

        // Save data to local storage whenever a relevant state variable changes
        useEffect(() => {
            const dataToSave = {
                headline, images, width, height, fontSize, lineHeight, fontFamily, textColor,
                textPos, direction, logo, fileName, sidelineOffset, shadow, stroke, sideline, fitMode
            };
            try {
                localStorage.setItem('socialCardData', JSON.stringify(dataToSave));
            } catch (e) {
                console.error("Failed to save data to localStorage", e);
            }
        }, [headline, images, width, height, fontSize, lineHeight, fontFamily, textColor,
            textPos, direction, logo, fileName, sidelineOffset, shadow, stroke, sideline, fitMode]);

        // Add a warning before the user closes or refreshes the page
        useEffect(() => {
          const handleBeforeUnload = (e) => {
            e.preventDefault();
            e.returnValue = '';
          };
          window.addEventListener('beforeunload', handleBeforeUnload);

          return () => {
            window.removeEventListener('beforeunload', handleBeforeUnload);
          };
        }, []);

        useEffect(() => {
          if (textRef.current && sideline.height === 0) {
            setSideline((s) => ({ ...s, height: textRef.current.offsetHeight }));
          }
        }, [headline, fontSize, lineHeight, fontFamily]);

        function onImageUpload(e) {
          const files = e.target.files;
          if (!files) return;
          const newImages = Array.from(files).map((file, index) => ({
            id: Date.now() + index,
            src: URL.createObjectURL(file),
            x: 0, 
            y: 0, 
            scale: 1, 
            zIndex: images.length + index,
            // Add unique feather state for each new image
            feather: { enabled: false, radius: 25 }
          }));
          setImages([...images, ...newImages]);
        }

        // --- UPDATED: Handler for changing feather properties on a specific image
        function setFeatherProperty(id, property, value) {
          setImages(imgs => imgs.map(img => {
            if (img.id === id) {
              return { ...img, feather: { ...img.feather, [property]: value } };
            }
            return img;
          }));
        }
        
        function getCoords(e) {
          return e.touches ? { x: e.touches[0].clientX, y: e.touches[0].clientY } : { x: e.clientX, y: e.clientY };
        }

        function getDistance(touches) {
          return Math.sqrt(
            Math.pow(touches[0].clientX - touches[1].clientX, 2) +
            Math.pow(touches[0].clientY - touches[1].clientY, 2)
          );
        }

        function startDragImage(e, id) {
          e.preventDefault();
          setActiveImageId(id);
          const { x: startX, y: startY } = getCoords(e);
          const img = images.find(im => im.id === id);
          const initX = img.x, initY = img.y, initScale = img.scale;

          const onMove = (ev) => {
            if (ev.touches && ev.touches.length === 2) {
              const currentDist = getDistance(ev.touches);
              if (touchStartDist) {
                const scale = (currentDist / touchStartDist) * initScale;
                setImages((imgs) => imgs.map(im => im.id === id ? { ...im, scale: scale > 0.1 ? scale : 0.1 } : im));
              }
            } else {
              const { x: currentX, y: currentY } = getCoords(ev);
              setImages((imgs) => imgs.map(im => im.id === id ? { ...im, x: initX + currentX - startX, y: initY + currentY - startY } : im));
            }
          };

          const onUp = () => {
            setTouchStartDist(null);
            window.removeEventListener("mousemove", onMove);
            window.removeEventListener("mouseup", onUp);
            window.removeEventListener("touchmove", onMove);
            window.removeEventListener("touchend", onUp);
          };

          if (e.touches && e.touches.length === 2) {
              setTouchStartDist(getDistance(e.touches));
          } else {
              setTouchStartDist(null);
          }

          window.addEventListener("mousemove", onMove);
          window.addEventListener("mouseup", onUp);
          window.addEventListener("touchmove", onMove);
          window.addEventListener("touchend", onUp);
        }

        function startDragText(e) {
          e.preventDefault();
          const { x: startX, y: startY } = getCoords(e);
          const initPos = { ...textPos };
          function onMove(ev) {
            const { x: currentX, y: currentY } = getCoords(ev);
            setTextPos({ x: initPos.x + currentX - startX, y: initPos.y + currentY - startY });
          }
          function onUp() {
            window.removeEventListener("mousemove", onMove);
            window.removeEventListener("mouseup", onUp);
            window.removeEventListener("touchmove", onMove);
            window.removeEventListener("touchend", onUp);
          }
          window.addEventListener("mousemove", onMove);
          window.addEventListener("mouseup", onUp);
          window.addEventListener("touchmove", onMove);
          window.addEventListener("touchend", onUp);
        }

        function exportAsImage() {
          if (!containerRef.current) return;
          const verticalOffset = 3;
          html2canvas(containerRef.current, {useCORS:true, scale:1, onclone:(clonedDoc)=> {
            const clonedLine = clonedDoc.querySelector(".sideline-clone");
            if(clonedLine){ const currentTop = parseFloat(clonedLine.style.top||"0"); clonedLine.style.top=currentTop+verticalOffset+"px";}
          }}).then((canvas)=>{
            const link = document.createElement("a");
            link.download = (fileName && fileName.trim()?fileName.trim():"social-card")+".png";
            link.href = canvas.toDataURL("image/png"); link.click();
          });
        }

        function changeImageScale(id, scale){ setImages((imgs)=>imgs.map(im=>im.id===id?{...im, scale}:im)) }
        function bringForward(id){ const maxZ=Math.max(...images.map(im=>im.zIndex)); setImages((imgs)=>imgs.map(im=>im.id===id?{...im,zIndex:maxZ+1}:im)) }
        function sendBackward(id){ const minZ=Math.min(...images.map(im=>im.zIndex)); setImages((imgs)=>imgs.map(im=>im.id===id?{...im,zIndex:minZ-1}:im)) }
        function deleteImage(id){ setImages((imgs)=>imgs.filter(im=>im.id!==id)) }
        function selectImage(id) {
          setActiveImageId(id);
          const maxZ = Math.max(...images.map(im => im.zIndex));
          setImages((imgs) => imgs.map(im => im.id === id ? { ...im, zIndex: maxZ + 1 } : im));
          setShowControls(true);
        }

        const activeImage = images.find(img => img.id === activeImageId);

        return (
          <div className="p-4 relative min-h-screen">

            {/* Main Preview Area */}
            <div className="flex flex-col items-center justify-center p-4">
              <div className="mb-2">Preview (Output size: {width}Ã—{height})</div>
              <div ref={containerRef} className="relative mx-auto bg-black overflow-hidden shadow-2xl" style={{width,height}}>
                {/* SVG for masks - this is critical for html2canvas compatibility */}
                <svg width="0" height="0" className="absolute">
                  {images.map(img => img.feather.enabled && (
                    <mask id={`mask-${img.id}`}>
                      <rect x="0" y="0" width="100%" height="100%" fill="url(#grad-${img.id})" />
                    </mask>
                  ))}
                  {images.map(img => img.feather.enabled && (
                    <radialGradient id={`grad-${img.id}`} cx="50%" cy="50%" r="50%">
                      {/* --- FIX: Invert the gradient stops to go from opaque center to transparent edges --- */}
                      <stop offset="0%" stopColor="white" stopOpacity="1" />
                      <stop offset={`${img.feather.radius}%`} stopColor="white" stopOpacity="0" />
                    </radialGradient>
                  ))}
                </svg>

                {/* Images */}
                {images.sort((a, b) => a.zIndex - b.zIndex).map(img => (
                  <img key={img.id} src={img.src} 
                       onMouseDown={e => startDragImage(e, img.id)}
                       onTouchStart={e => startDragImage(e, img.id)}
                       style={{
                         position: "absolute",
                         left: img.x,
                         top: img.y,
                         transform: `scale(${img.scale})`,
                         cursor: "grab",
                         width: fitMode === "stretch" ? "100%" : "auto",
                         height: fitMode === "stretch" ? "100%" : "auto",
                         border: activeImageId === img.id ? '2px solid #3b82f6' : 'none',
                         mask: img.feather.enabled ? `url(#mask-${img.id})` : 'none',
                         WebkitMask: img.feather.enabled ? `url(#mask-${img.id})` : 'none'
                       }}
                  />
                ))}

                {/* Sideline */}
                {sideline.show && <div className="sideline-clone" style={{
                  position: "absolute",
                  [direction === "ltr" ? "left" : "right"]: sideline.gap,
                  top: textPos.y + sidelineOffset,
                  height: sideline.height || textRef.current?.offsetHeight || 0,
                  width: sideline.width,
                  background: sideline.color,
                  opacity: sideline.opacity
                }} />}

                {/* Logo */}
                {logo.show && <img src="sabah-logo.PNG" alt="Logo" style={{position:"absolute", width:120,height:60,
                  ...(logo.position==="top-left"?{left:30,top:150}:{})
                  ,...(logo.position==="top-right"?{right:30,top:150}:{})
                  ,...(logo.position==="bottom-left"?{left:30,bottom:150}:{})
                  ,...(logo.position==="bottom-right"?{right:30,bottom:150}:{})
                }}/>}
                
                {/* Headline */}
                <div ref={textRef} onMouseDown={startDragText} onTouchStart={startDragText} dir={direction} style={{
                  position: "absolute", left: textPos.x, top: textPos.y,
                  fontSize, lineHeight, fontFamily, color: textColor,
                  textShadow: shadow.enabled ? `${shadow.offsetX}px ${shadow.offsetY}px ${shadow.blur}px ${shadow.color}` : "none",
                  WebkitTextStroke: stroke.enabled ? `${stroke.width}px ${stroke.color}` : "none",
                  whiteSpace: "pre-wrap", cursor: "move"
                }}>{headline}</div>
              </div>

              {/* Mobile controls button */}
              <button onClick={() => setShowControls(true)} className="fixed bottom-4 right-4 bg-blue-600 text-white p-4 rounded-full shadow-lg md:hidden">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M10.343 3.94c.061-.518.337-1.001.751-1.311C11.547 2.215 12 2.651 12 3.208V5.5c.348.061.684.156 1 .288m-9.657 9.53a.987.987 0 01-.751 1.313c-.414.31-.482.802-.153 1.259a2.49 2.49 0 001.691 1.056c.86-.067 1.761-.17 2.65-.308m-.008-10.283C6.736 8.52 8 8.868 9 9c.148-.008.29-.028.43-.058.463-.099.932-.15 1.4-.15.468 0 .937.051 1.4.15.14.03.282.05.43.058 1-.132 2.264-.48 3.522-1.049m-9.657 9.53a.987.987 0 01-.153-1.259c.329-.457.886-.673 1.691-1.056m-.751 1.313a.987.987 0 011.313-.751l.711.23c.307.099.643.15.98.15.337 0 .673-.051.98-.15l.711-.23m-4.269 1.111C9.657 15.65 11 15.998 12 16.13c.148-.008.29-.028.43-.058.463-.099.932-.15 1.4-.15.468 0 .937.051 1.4.15.14.03.282.05.43.058 1-.132 2.264-.48 3.522-1.049m-9.657 9.53a.987.987 0 01-.751 1.313c-.414.31-.482.802-.153 1.259a2.49 2.49 0 001.691 1.056c.86-.067 1.761-.17 2.65-.308m-.008-10.283a.987.987 0 01-.153-1.259c.329-.457.886-.673 1.691-1.056m-4.269 1.111a2.49 2.49 0 001.691 1.056c.86-.067 1.761-.17 2.65-.308m-4.269 1.111a.987.987 0 01-.751 1.313c-.414.31-.482.802-.153 1.259a2.49 2.49 0 001.691 1.056c.86-.067 1.761-.17 2.65-.308m-.008-10.283a.987.987 0 01-.153-1.259c.329-.457.886-.673 1.691-1.056" />
                </svg>
              </button>
            </div>

            {/* Mobile-First Control Drawer */}
            <div className={`fixed inset-0 z-50 md:hidden transition-transform transform ${showControls ? 'translate-x-0' : 'translate-x-full'}`}>
              <div className="absolute inset-0 drawer-overlay" onClick={() => setShowControls(false)}></div>
              <div className="absolute top-0 right-0 w-full max-w-sm h-full bg-white p-4 overflow-y-auto shadow-lg drawer-open">
                <div className="flex justify-end">
                  <button onClick={() => setShowControls(false)} className="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8">
                      <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <div className="w-full space-y-4">
                  <h2 className="text-xl font-semibold">Controls</h2>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="block text-sm font-medium">Headline</label>
                    <textarea dir={direction} value={headline} onChange={e=>setHeadline(e.target.value)} className="w-full border p-2 rounded" />
                    <label className="block text-sm mt-2">Font size</label>
                    <input type="number" value={fontSize} onChange={e=>setFontSize(parseInt(e.target.value))} className="w-full border p-1 rounded"/>
                    <label className="block text-sm mt-2">Line height</label>
                    <input type="number" step="0.1" value={lineHeight} onChange={e=>setLineHeight(parseFloat(e.target.value))} className="w-full border p-1 rounded"/>
                    <label className="block text-sm mt-2">Text color</label>
                    <input type="color" value={textColor} onChange={e=>setTextColor(e.target.value)}/>
                    <label className="block text-sm mt-3">Font family</label>
                    <select value={fontFamily} onChange={e=>setFontFamily(e.target.value)} className="w-full border p-1 rounded mt-2">
                      <option value="Jameel Noori Nastaleeq">Jameel Noori Nastaleeq</option>
                      <option value="JameelNooriNastaliq">Jameel Noori embed</option>
                      <option value="Pangea Afrikan Trial">Pangea</option>
                      <option value="Tahoma">Tahoma</option>
                      <option value="Arial">Arial</option>
                    </select>
                    <label className="block text-sm mt-3">Text direction</label>
                    <select value={direction} onChange={e=>setDirection(e.target.value)} className="w-full border p-1 rounded mt-2">
                      <option value="ltr">Left to Right</option>
                      <option value="rtl">Right to Left</option>
                    </select>
                  </div>

                  {activeImage && (
                    <div className="bg-blue-50 p-3 rounded shadow space-y-2">
                        <h3 className="text-lg font-medium">Image Controls</h3>
                        <div className="flex justify-between items-center">
                            <span className="text-sm">Image {activeImage.id}</span>
                            <button onClick={() => deleteImage(activeImage.id)} className="text-red-500 text-sm">Delete</button>
                        </div>
                        <label className="block text-sm">Zoom</label>
                        <input type="range" min="0.1" max="3" step="0.05" value={activeImage.scale} onChange={e => changeImageScale(activeImage.id, parseFloat(e.target.value))} className="w-full" />
                        <div className="flex gap-2 mt-1">
                            <button onClick={() => bringForward(activeImage.id)} className="bg-gray-200 px-2 py-1 rounded text-sm">Bring Forward</button>
                            <button onClick={() => sendBackward(activeImage.id)} className="bg-gray-200 px-2 py-1 rounded text-sm">Send Backward</button>
                        </div>
                        <div className="bg-white p-3 rounded shadow">
                          <label className="flex items-center">
                              <input type="checkbox" checked={activeImage.feather.enabled} onChange={e => setFeatherProperty(activeImage.id, 'enabled', e.target.checked)} />
                              <span className="ml-2">Enable Feathering</span>
                          </label>
                          {activeImage.feather.enabled && (
                            <div className="mt-2">
                                <label className="block text-sm">Feather Radius ({activeImage.feather.radius}%)</label>
                                <input type="range" min="0" max="100" value={activeImage.feather.radius} onChange={e => setFeatherProperty(activeImage.id, 'radius', parseInt(e.target.value))} className="w-full" />
                            </div>
                          )}
                        </div>
                    </div>
                  )}

                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={shadow.enabled} onChange={e=>setShadow({...shadow,enabled:e.target.checked})}/>
                      <span className="ml-2">Enable shadow</span>
                    </label>
                    {shadow.enabled && <div className="mt-2 grid grid-cols-2 gap-2">
                      <label className="text-sm">OffsetX<input type="number" value={shadow.offsetX} onChange={e=>setShadow({...shadow,offsetX:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">OffsetY<input type="number" value={shadow.offsetY} onChange={e=>setShadow({...shadow,offsetY:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">Blur<input type="number" value={shadow.blur} onChange={e=>setShadow({...shadow,blur:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">Color<input type="color" value={shadow.color} onChange={e=>setShadow({...shadow,color:e.target.value})} className="w-full border p-1 rounded"/></label>
                    </div>}
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={stroke.enabled} onChange={e=>setStroke({...stroke,enabled:e.target.checked})}/>
                      <span className="ml-2">Enable stroke</span>
                    </label>
                    {stroke.enabled && <div className="mt-2 grid grid-cols-2 gap-2">
                      <label className="text-sm">Width<input type="number" value={stroke.width} onChange={e=>setStroke({...stroke,width:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">Color<input type="color" value={stroke.color} onChange={e=>setStroke({...stroke,color:e.target.value})} className="w-full border p-1 rounded"/></label>
                    </div>}
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={sideline.show} onChange={e=>setSideline({...sideline,show:e.target.checked})}/>
                      <span className="ml-2">Show sideline</span>
                    </label>
                    {sideline.show && <>
                      <label className="block text-sm">Width<input type="number" value={sideline.width} onChange={e=>setSideline({...sideline,width:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Gap<input type="number" value={sideline.gap} onChange={e=>setSideline({...sideline,gap:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Height<input type="number" value={sideline.height} onChange={e=>setSideline({...sideline,height:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Color<input type="color" value={sideline.color} onChange={e=>setSideline({...sideline,color:e.target.value})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Transparency<input type="range" min="0" max="1" step="0.05" value={sideline.opacity} onChange={e=>setSideline({...sideline,opacity:parseFloat(e.target.value)})} className="w-full"/></label>
                      <label className="block text-sm">Vertical offset<input type="number" value={sidelineOffset} onChange={e=>setSidelineOffset(parseInt(e.target.value))} className="w-full border p-1 rounded mt-1"/></label>
                    </>}
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="block text-sm font-medium">Upload images</label>
                    <input type="file" accept="image/*" multiple onChange={onImageUpload} className="mt-2"/>
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={logo.show} onChange={e=>setLogo({...logo,show:e.target.checked})}/>
                      <span className="ml-2">Show Logo</span>
                    </label>
                    {logo.show &&
                      <select value={logo.position} onChange={e=>setLogo({...logo,position:e.target.value})} className="w-full border p-1 rounded mt-2">
                        <option value="top-left">Top Left</option>
                        <option value="top-right">Top Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    }
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="block text-sm font-medium">Canvas size</label>
                    <div className="flex gap-2 mt-2 flex-wrap">
                      <button
                        onClick={() => { setWidth(1080); setHeight(1080); }}
                        className="bg-gray-200 px-3 py-1 rounded"
                      >
                        Instagram Square
                      </button>
                      <button
                        onClick={() => { setWidth(1080); setHeight(1920); }}
                        className="bg-gray-200 px-3 py-1 rounded"
                      >
                        Instagram Story
                      </button>
                      <button
                        onClick={() => { setWidth(1200); setHeight(720); }}
                        className="bg-gray-200 px-3 py-1 rounded"
                      >
                        YouTube
                      </button>
                    </div>
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow space-y-2">
                    <label className="block text-sm">File name</label>
                    <input type="text" value={fileName} onChange={e=>setFileName(e.target.value)} className="w-full border p-1 rounded"/>
                    <label className="block text-sm">Fit mode</label>
                    <select value={fitMode} onChange={e=>setFitMode(e.target.value)} className="w-full border p-1 rounded">
                      <option value="cover">Cover</option>
                      <option value="contain">Contain</option>
                      <option value="stretch">Stretch</option>
                    </select>
                    <button onClick={exportAsImage} className="w-full bg-blue-600 text-white py-2 rounded mt-2">Export PNG</button>
                  </div>
                </div>
              </div>
            </div>

            {/* Desktop controls panel */}
            <div className="hidden md:block fixed top-0 left-0 h-full w-96 bg-white p-4 overflow-y-auto shadow-lg z-50">
              <div className="space-y-4">
                <h2 className="text-xl font-semibold">Controls</h2>
                <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="block text-sm font-medium">Headline</label>
                    <textarea dir={direction} value={headline} onChange={e=>setHeadline(e.target.value)} className="w-full border p-2 rounded" />
                    <label className="block text-sm mt-2">Font size</label>
                    <input type="number" value={fontSize} onChange={e=>setFontSize(parseInt(e.target.value))} className="w-full border p-1 rounded"/>
                    <label className="block text-sm mt-2">Line height</label>
                    <input type="number" step="0.1" value={lineHeight} onChange={e=>setLineHeight(parseFloat(e.target.value))} className="w-full border p-1 rounded"/>
                    <label className="block text-sm mt-2">Text color</label>
                    <input type="color" value={textColor} onChange={e=>setTextColor(e.target.value)}/>
                    <label className="block text-sm mt-3">Font family</label>
                    <select value={fontFamily} onChange={e=>setFontFamily(e.target.value)} className="w-full border p-1 rounded mt-2">
                      <option value="Jameel Noori Nastaleeq">Jameel Noori Nastaleeq</option>
					            <option value="JameelNooriNastaliq">Jameel Noori embed</option>
                      <option value="Pangea Afrikan Trial">Pangea</option>
                      <option value="Tahoma">Tahoma</option>
                      <option value="Arial">Arial</option>
                    </select>
                    <label className="block text-sm mt-3">Text direction</label>
                    <select value={direction} onChange={e=>setDirection(e.target.value)} className="w-full border p-1 rounded mt-2">
                      <option value="ltr">Left to Right</option>
                      <option value="rtl">Right to Left</option>
                    </select>
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={shadow.enabled} onChange={e=>setShadow({...shadow,enabled:e.target.checked})}/>
                      <span className="ml-2">Enable shadow</span>
                    </label>
                    {shadow.enabled && <div className="mt-2 grid grid-cols-2 gap-2">
                      <label className="text-sm">OffsetX<input type="number" value={shadow.offsetX} onChange={e=>setShadow({...shadow,offsetX:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">OffsetY<input type="number" value={shadow.offsetY} onChange={e=>setShadow({...shadow,offsetY:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">Blur<input type="number" value={shadow.blur} onChange={e=>setShadow({...shadow,blur:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">Color<input type="color" value={shadow.color} onChange={e=>setShadow({...shadow,color:e.target.value})} className="w-full border p-1 rounded"/></label>
                    </div>}
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={stroke.enabled} onChange={e=>setStroke({...stroke,enabled:e.target.checked})}/>
                      <span className="ml-2">Enable stroke</span>
                    </label>
                    {stroke.enabled && <div className="mt-2 grid grid-cols-2 gap-2">
                      <label className="text-sm">Width<input type="number" value={stroke.width} onChange={e=>setStroke({...stroke,width:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="text-sm">Color<input type="color" value={stroke.color} onChange={e=>setStroke({...stroke,color:e.target.value})} className="w-full border p-1 rounded"/></label>
                    </div>}
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={sideline.show} onChange={e=>setSideline({...sideline,show:e.target.checked})}/>
                      <span className="ml-2">Show sideline</span>
                    </label>
                    {sideline.show && <>
                      <label className="block text-sm">Width<input type="number" value={sideline.width} onChange={e=>setSideline({...sideline,width:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Gap<input type="number" value={sideline.gap} onChange={e=>setSideline({...sideline,gap:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Height<input type="number" value={sideline.height} onChange={e=>setSideline({...sideline,height:parseInt(e.target.value)})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Color<input type="color" value={sideline.color} onChange={e=>setSideline({...sideline,color:e.target.value})} className="w-full border p-1 rounded"/></label>
                      <label className="block text-sm">Transparency<input type="range" min="0" max="1" step="0.05" value={sideline.opacity} onChange={e=>setSideline({...sideline,opacity:parseFloat(e.target.value)})} className="w-full"/></label>
                      <label className="block text-sm">Vertical offset<input type="number" value={sidelineOffset} onChange={e=>setSidelineOffset(parseInt(e.target.value))} className="w-full border p-1 rounded mt-1"/></label>
                    </>}
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="block text-sm font-medium">Upload images</label>
                    <input type="file" accept="image/*" multiple onChange={onImageUpload} className="mt-2"/>
                  </div>
                  
                  {images.map(img=>(
                    <div key={img.id} className={`bg-gray-50 p-3 rounded shadow space-y-1 ${activeImageId === img.id ? 'border-2 border-blue-500' : ''}`}>
                      <div className="flex justify-between items-center">
                        <span className="text-sm">Image {img.id}</span>
                        <button onClick={()=>deleteImage(img.id)} className="text-red-500 text-sm">Delete</button>
                      </div>
                      <label className="block text-sm">Zoom</label>
                      <input type="range" min="0.1" max="3" step="0.05" value={img.scale} onChange={e => changeImageScale(img.id, parseFloat(e.target.value))} className="w-full" />
                      <div className="flex gap-2 mt-1">
                        <button onClick={()=>bringForward(img.id)} className="bg-gray-200 px-2 py-1 rounded text-sm">Bring Forward</button>
                        <button onClick={()=>sendBackward(img.id)} className="bg-gray-200 px-2 py-1 rounded text-sm">Send Backward</button>
                      </div>
                      <div className="bg-white p-3 rounded shadow mt-2">
                        <label className="flex items-center">
                            <input type="checkbox" checked={img.feather.enabled} onChange={e => setFeatherProperty(img.id, 'enabled', e.target.checked)} />
                            <span className="ml-2">Enable Feathering</span>
                        </label>
                        {img.feather.enabled && (
                          <div className="mt-2">
                              <label className="block text-sm">Feather Radius ({img.feather.radius}%)</label>
                              <input type="range" min="0" max="100" value={img.feather.radius} onChange={e => setFeatherProperty(img.id, 'radius', parseInt(e.target.value))} className="w-full" />
                          </div>
                        )}
                      </div>
                    </div>
                  ))}
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="flex items-center">
                      <input type="checkbox" checked={logo.show} onChange={e=>setLogo({...logo,show:e.target.checked})}/>
                      <span className="ml-2">Show Logo</span>
                    </label>
                    {logo.show &&
                      <select value={logo.position} onChange={e=>setLogo({...logo,position:e.target.value})} className="w-full border p-1 rounded mt-2">
                        <option value="top-left">Top Left</option>
                        <option value="top-right">Top Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    }
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow">
                    <label className="block text-sm font-medium">Canvas size</label>
                    <div className="flex gap-2 mt-2 flex-wrap">
                      <button
                        onClick={() => { setWidth(1080); setHeight(1080); }}
                        className="bg-gray-200 px-3 py-1 rounded"
                      >
                        Instagram Square
                      </button>
                      <button
                        onClick={() => { setWidth(1080); setHeight(1920); }}
                        className="bg-gray-200 px-3 py-1 rounded"
                      >
                        Instagram Story
                      </button>
                      <button
                        onClick={() => { setWidth(1200); setHeight(720); }}
                        className="bg-gray-200 px-3 py-1 rounded"
                      >
                        YouTube
                      </button>
                    </div>
                  </div>
                  
                  <div className="bg-gray-50 p-3 rounded shadow space-y-2">
                    <label className="block text-sm">File name</label>
                    <input type="text" value={fileName} onChange={e=>setFileName(e.target.value)} className="w-full border p-1 rounded"/>
                    <label className="block text-sm">Fit mode</label>
                    <select value={fitMode} onChange={e=>setFitMode(e.target.value)} className="w-full border p-1 rounded">
                      <option value="cover">Cover</option>
                      <option value="contain">Contain</option>
                      <option value="stretch">Stretch</option>
                    </select>
                    <button onClick={exportAsImage} className="w-full bg-blue-600 text-white py-2 rounded mt-2">Export PNG</button>
                  </div>
                </div>
            </div>

          </div>
        )
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<SocialCardGenerator />);
    </script>
  </body>
</html>
